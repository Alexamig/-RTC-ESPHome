# üîã –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–∞—Ç–∞—Ä–µ–π–∫–∏ RTC –¥–ª—è ESPHome
**–í–µ—Ä—Å–∏—è**: 1.6  
**ESPHome**: 2025.6.0+  
**–î–∞—Ç–∞**: 23.06.2025    

## üìã –û–ø–∏—Å–∞–Ω–∏–µ
–ü–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –±–∞—Ç–∞—Ä–µ–π–∫–∏ CR2032 –≤ –º–æ–¥—É–ª—è—Ö DS1307 —Å:
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–º –¥–µ–ª–∏—Ç–µ–ª–µ–º –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è (100k+220k)
- –û–ø–æ–≤–µ—â–µ–Ω–∏—è–º–∏ –≤ Telegram
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ–∫–∞–∑–∞–Ω–∏–π

## üõ† –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```circuit
–ë–∞—Ç–∞—Ä–µ–π–∫–∞+ (3V) ‚îÄ‚îÄ[R1 100k]‚îÄ‚îÄ‚îÄ ADC (A0)
                    |
                   [R2 220k]
                    |
                   GND

# -----------------------------------------------
#üìú –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ–Ω—Å–æ—Ä
sensor:
  - platform: adc
    pin: A0
    name: "RTC battery voltage"
    update_interval: 60s
    filters:
      - multiply: 1.4545
      - sliding_window_moving_average:
          window_size: 5
          send_every: 3
    accuracy_decimals: 2
    unit_of_measurement: "V"
    on_value_range:
      - below: 2.2  # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å
        then:
          - lambda: |-
              char message[100];
              char url[256];
              snprintf(message, sizeof(message), "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–π–∫–∏: %.2fV", x);
              snprintf(url, sizeof(url),
                "https://api.telegram.org/bot%s/sendMessage?chat_id=%s&text=%s&parse_mode=Markdown",
                "${telegram_token}",
                "${chat_id}",
                message);
              id(my_http_request).post(url, "");
              ESP_LOGE("main", "%s", message);

      - below: 2.4  # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
        then:
          - lambda: |-
              char message[100];
              char url[256];
              snprintf(message, sizeof(message), "–ë–∞—Ç–∞—Ä–µ–π–∫–∞ RTC —Ç—Ä–µ–±—É–µ—Ç –∑–∞–º–µ–Ω—ã: %.2fV", x);
              snprintf(url, sizeof(url),
                "https://api.telegram.org/bot%s/sendMessage?chat_id=%s&text=%s&parse_mode=Markdown",
                "${telegram_token}",
                "${chat_id}",
                message);
              id(my_http_request).post(url, "");
              ESP_LOGW("main", "%s", message);

# -----------------------------------------------
–ü–æ–¥–∫–ª—é—á–∏—Ç—å —Å—Ö–µ–º—É —Å —Ä–µ–∑–∏—Å—Ç–æ—Ä–∞–º–∏ 100k –∏ 220k

–î–æ–±–∞–≤—å—Ç–µ –≤ –≤–∞—à secrets.yaml:
telegram_token: "–≤–∞—à_—Ç–æ–∫–µ–Ω"
telegram_chat_id: "–≤–∞—à_chat_id"

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
http_request:
  useragent: ESPHome
  timeout: 30s

üîå –†–∞—Å—á–µ—Ç –¥–µ–ª–∏—Ç–µ–ª—è
V_out = 3.0V * (220k / (100k + 220k)) ‚âà 2.06V
–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è –∫–æ–¥–∞: (100k + 220k) / 220k ‚âà 1.4545


üìä –¢–∞–±–ª–∏—Ü–∞ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π
–ü–æ–∫–∞–∑–∞–Ω–∏–µ (V)	–†–µ–∞–ª—å–Ω–æ–µ (V)	–°—Ç–∞—Ç—É—Å
2.06	3.00	–ù–æ—Ä–º–∞
1.93	2.80	–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
1.80	2.60	–°–∫–æ—Ä–æ –∑–∞–º–µ–Ω–∞!
